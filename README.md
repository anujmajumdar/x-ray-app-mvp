X-Ray: Decision Observability SDK & Dashboard

X-Ray is a lightweight observability tool designed for non-deterministic software pipelines (LLMs, heuristic filters, and complex ranking algorithms). While traditional logging tracks execution flow, X-Ray tracks reasoning flow.

üöÄ Quick Start
1. Prerequisites

    Node.js 18.x or higher

    npm or yarn

2. Installation
Bash

# Clone the repository
git clone <your-repo-url>
cd xray-assignment

# Install dependencies
npm install

3. Run Development Server
Bash

npm run dev

Open http://localhost:3000 to view the dashboard. Click "Run Demo Workflow" to trigger the multi-category test suite including success and failure scenarios.
üí° Technical Approach
1. The "Step" Abstraction (lib/xray-sdk.ts)

The SDK treats every logic block as a "Step." By wrapping code in xray.step(), the developer gets:

    Automatic Error Boundary: If a step throws an error (e.g., API timeout), the SDK catches it, marks the trace as failed, and captures the error message in the output context without crashing the parent process.

    Reasoning Capture: A dedicated logReasoning channel for "Chain of Thought" logging.

    The Decision Matrix: A logEval method specifically for filtering/ranking, allowing the UI to render why specific items were kept or dropped.

2. Multi-Step Demo Architecture (lib/demo-workflows.ts)

The demo mimics a real-world Amazon Competitor Selection tool across 5 distinct phases:

    Keyword Gen: LLM-based entity extraction.

    Search API: Mocked retrieval.

    Business Filters: Hard-coded logic (Price, Ratings, Reviews).

    LLM Relevance: Semantic check to eliminate "False Positives" (e.g., a bottle brush appearing in a search for bottles).

    Composite Ranking: Weighted scoring (40% Relevance, 30% Popularity, etc.).

3. Smart Persistence (lib/storage.ts)

To ensure zero-config for the reviewer, I implemented a Shared Memory Store. The SDK is "Isomorphic"‚Äîit detects if it's running on the server (writing directly to memory) or the client (using the Ingest API), preventing data loss across environment boundaries.
üîç Key Features

    Failure Diagnostics: The UI highlights failed steps in red and displays the specific error message (e.g., "API Rate Limit Exceeded").

    The "Why" Table: The dashboard doesn't just show a list of products; it shows a table of every candidate that was dropped and the specific business rule that killed it.

    Semantic Scoring: Visualizes the "hidden" scores generated by LLM relevance evaluations.

üöß Known Limitations & Future Improvements
Current Limitations

    Ephemeral Storage: Traces are stored in RAM and will clear when the Next.js dev server restarts.

    Linear Execution: The current SDK/UI supports sequential steps but does not yet visualize parallel Promise.all execution paths.

    Mocked Services: All external calls (LLM, API) are simulated to ensure the demo is 100% reliable for review.

Future Roadmap

    Persistence: Replace lib/storage.ts with a Postgres JSONB column to allow for SQL querying of decision patterns.

    Replay Engine: Add the ability to "Re-run from this step" using the captured input to test logic changes (e.g., adjusting a price threshold) without re-fetching all data.

    Regression Testing: Use captured X-Ray traces as "Gold Data" sets to ensure future logic changes don't accidentally drop valid competitors.
